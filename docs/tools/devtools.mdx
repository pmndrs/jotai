---
title: Devtools
description: This doc describes Devtools for Jotai.
nav: 5.03
keywords: devtools,debug,snapshot
---

### å®‰è£… {#install}

å°† `jotai-devtools` å®‰è£…åˆ°ä½ çš„é¡¹ç›®ä¸­ä»¥å¼€å§‹ä½¿ç”¨ã€‚

```sh
npm i jotai-devtools
```

### æ³¨æ„äº‹é¡¹ {#notes}

- `<DevTools/>` å·²ä¼˜åŒ–ä¸ºç”Ÿäº§æ„å»ºçš„ tree-shakableï¼Œ**ä»…åœ¨éç”Ÿäº§ç¯å¢ƒä¸­å·¥ä½œ**
- Hooks æ˜¯ä»…å¼€å‘è€…ä½¿ç”¨çš„ï¼Œè®¾è®¡ä¸ºåœ¨éç”Ÿäº§ç¯å¢ƒä¸­å·¥ä½œ
- æ¬¢è¿åé¦ˆï¼Œå¦‚æœ‰é—®é¢˜è¯·åœ¨ [Jotai DevTools GitHub Repo](https://github.com/jotaijs/jotai-devtools/discussions) æå‡º

### å¿«é€Ÿé“¾æ¥ {#quick-links}

- [UI Devtools](#ui-devtools)
- Hooks
  - [useAtomsDebugValue](#useatomsdebugvalue)
  - [useAtomDevtools](#useatomdevtools)
  - [useAtomsDevtools](#useatomsdevtools)
  - [useAtomsSnapshot](#useatomssnapshot)
  - [useGotoAtomsSnapshot](#usegotoatomssnapshot)
- è¿ç§»æŒ‡å—
  - [ä» `@emotion/react` è¿ç§»](https://github.com/jotaijs/jotai-devtools?tab=readme-ov-file#migrate-%C6%92rom-emotionreact-to-native-css)

### UI DevTools {#ui-devtools}

ä½¿ç”¨åŸºäº UI çš„ Jotai DevTool æå‡ä½ çš„å¼€å‘ä½“éªŒã€‚

#### Babel æ’ä»¶è®¾ç½® - (_å¯é€‰ä½†å¼ºçƒˆæ¨è_) {#babel-plugin-setup---(_optional-but-highly-recommended_)}

ä½¿ç”¨ Jotai babel æ’ä»¶ä»¥è·å¾—æœ€ä½³çš„è°ƒè¯•ä½“éªŒã€‚åœ¨ [babel](../tools/babel) é¡µé¢å’Œ/æˆ– [swc](../tools/swc) é¡µé¢æ‰¾åˆ°å®Œæ•´æŒ‡å—ã€‚

ç¤ºä¾‹ï¼š

```ts
{
  "presets": [
    // é¢„è®¾åŒ…å«ä¸¤ä¸ªæ’ä»¶ï¼š
    // - jotai/babel/plugin-react-refresh ä»¥å¯ç”¨ atoms çš„çƒ­é‡è½½
    // - jotai/babel/plugin-debug-label ä»¥è‡ªåŠ¨å‘ atoms æ·»åŠ è°ƒè¯•æ ‡ç­¾
    'jotai/babel/preset'
  ]
}
```

Vite + React é¡¹ç›®çš„ç¤ºä¾‹ï¼š

```ts
// vite.config.ts

export default defineConfig({
  plugins: [
    react({
      babel: {
        presets: ['jotai/babel/preset'],
      },
    }),
  ],
})
```

### Next JS è®¾ç½® {#next-js-setup}

_å¦‚æœä½ ä¸ä½¿ç”¨ [Next.js](https://nextjs.org)ï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚_

å¯ç”¨ `transpilePackages` ä»¥æ­£ç¡®åœ°è½¬è¯‘ UI CSS å’Œç»„ä»¶ã€‚

```ts
// next.config.ts
const nextConfig = {
  // åœ¨è¿™é‡Œäº†è§£æ›´å¤š - https://nextjs.org/docs/advanced-features/compiler#module-transpilation
  // ä¸ºäº†æ­£ç¡®åœ°è½¬è¯‘ UI cssï¼Œè¿™æ˜¯å¿…éœ€çš„ ğŸ‘‡
  transpilePackages: ['jotai-devtools'],
}
module.exports = nextConfig
```

### å¯ç”¨çš„ props {#available-props}

```ts
type DevToolsProps = {
  // é»˜è®¤ä¸º false
  isInitialOpen?: boolean
  // ä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰çš„ store
  store?: Store
  // é»˜è®¤ä¸º light
  theme?: 'dark' | 'light'
  // è®¾ç½®è§¦å‘æŒ‰é’®çš„ä½ç½®
  // é»˜è®¤ä¸º `bottom-left`
  position?: 'top-right' | 'top-left' | 'bottom-right' | 'bottom-left'
  // è‡ªå®šä¹‰ nonce ä»¥é€šè¿‡ CSP å…è®¸ jotai-devtools ç‰¹å®šçš„å†…è”æ ·å¼
  nonce?: string
  options?: {
    // ç§æœ‰ atoms åœ¨ atom creatorsï¼ˆå¦‚ `atomWithStorage` æˆ– `atomWithLocation` ç­‰ï¼‰å†…éƒ¨ä½¿ç”¨ï¼Œä»¥ç®¡ç†å†…éƒ¨çŠ¶æ€ã€‚
    // é»˜è®¤ä¸º `false`
    shouldShowPrivateAtoms?: boolean
    // åœ¨ Atom Viewer æ ‡ç­¾ã€Timeline æ ‡ç­¾ç­‰çš„åˆå§‹æ¸²æŸ“ä¸Šå±•å¼€ JSON æ ‘è§†å›¾ã€‚
    // é»˜è®¤ä¸º `false`
    shouldExpandJsonTreeViewInitially?: boolean
    // æ—¶é—´æ—…è¡Œå›æ”¾çš„æ¯ä¸€æ­¥ä¹‹é—´çš„é—´éš”ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚
    // é»˜è®¤ä¸º `750ms`
    timeTravelPlaybackInterval?: number
    // åœ¨å†å²è®°å½•ä¸­ä¿ç•™çš„å¿«ç…§çš„æœ€å¤§æ•°é‡ã€‚
    // æ•°å­—è¶Šå¤§ï¼Œæ¶ˆè€—çš„å†…å­˜å°±è¶Šå¤šã€‚
    // é»˜è®¤ä¸º `Infinity`ã€‚æ¨èï¼š`~30`
    snapshotHistoryLimit?: number
  }
}
```

### ä½¿ç”¨ {#usage}

#### æ—  Provider {#provider-less}

```tsx
import { DevTools } from 'jotai-devtools'
import 'jotai-devtools/styles.css'

const App = () => {
  return (
    <>
      <DevTools />
      {/* ä½ çš„åº”ç”¨ */}
    </>
  )
}
```

#### æœ‰ Provider {#with-provider}

```tsx
import { createStore } from 'jotai'
import { DevTools } from 'jotai-devtools'
import 'jotai-devtools/styles.css'

const customStore = createStore()

const App = () => {
  return (
    <Provider store={customStore}>
      <DevTools store={customStore} />
      {/* ä½ çš„åº”ç”¨ */}
    </Provider>
  )
}
```

### é¢„è§ˆ {#preview}

<CodeSandbox id="k5p12d" />

## useAtomsDebugValue {#useatomsdebugvalue}

`useAtomsDebugValue` æ˜¯ä¸€ä¸ª React é’©å­ï¼Œå®ƒä¼šåœ¨ React Devtools ä¸­æ˜¾ç¤ºæ‰€æœ‰çš„ atom å€¼ã€‚

```ts
function useAtomsDebugValue(options?: {
  store?: Store
  enabled?: boolean
}): void
```

åœ¨å†…éƒ¨ï¼Œå®ƒä½¿ç”¨ `useDebugValue`ï¼Œè¿™åªåœ¨ DEV æ¨¡å¼ä¸‹æœ‰æ•ˆã€‚
å®ƒä¼šæ•è·ä»é’©å­æ‰€åœ¨ä½ç½®å¯ä»¥è®¿é—®çš„æ‰€æœ‰ atomsã€‚

### ç¤ºä¾‹ {#example}

```jsx
import { useAtomsDebugValue } from 'jotai-devtools/utils'

const textAtom = atom('hello')
textAtom.debugLabel = 'textAtom'

const lenAtom = atom((get) => get(textAtom).length)
lenAtom.debugLabel = 'lenAtom'

const TextBox = () => {
  const [text, setText] = useAtom(textAtom)
  const [len] = useAtom(lenAtom)
  return (
    <span>
      <input value={text} onChange={(e) => setText(e.target.value)} />({len})
    </span>
  )
}

const DebugAtoms = () => {
  useAtomsDebugValue()
  return null
}

const App = () => (
  <Provider>
    <DebugAtoms />
    <TextBox />
  </Provider>
)
```

<CodeSandbox id="vvp12f" />

## useAtomDevtools {#useatomdevtools}

`useAtomDevtools` æ˜¯ä¸€ä¸ª React é’©å­ï¼Œå®ƒä¸ºç‰¹å®šçš„ atom ç®¡ç† ReduxDevTools æ‰©å±•ã€‚

```ts
function useAtomDevtools<Value>(
  anAtom: WritableAtom<Value, Value>,
  options?: {
    store?: Store
    name?: string
    enabled?: boolean
  },
): void
```

`useAtomDevtools` é’©å­æ¥å—ä¸€ä¸ªæ³›å‹ç±»å‹å‚æ•°ï¼ˆåæ˜ å­˜å‚¨åœ¨ atom ä¸­çš„ç±»å‹ï¼‰ã€‚æ­¤å¤–ï¼Œé’©å­æ¥å—ä¸¤ä¸ªè°ƒç”¨å‚æ•°ï¼Œ`anAtom` å’Œ `name`ã€‚
`anAtom` æ˜¯å°†é™„åŠ åˆ° devtools å®ä¾‹çš„ atomã€‚`name` æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®šä¹‰ devtools å®ä¾‹çš„è°ƒè¯•æ ‡ç­¾ã€‚å¦‚æœ `name` æœªå®šä¹‰ï¼Œå°†ä½¿ç”¨ `atom.debugLabel`ã€‚

### ç¤ºä¾‹ {#example}

```ts
import { useAtomDevtools } from 'jotai-devtools/utils'

// å­˜å‚¨åœ¨ atom ä¸­çš„ç±»å‹çš„æ¥å£ã€‚
export interface Task {
  label: string
  complete: boolean
}

// è¦è°ƒè¯•çš„ atomã€‚
export const tasksAtom = atom<Task[]>([])

// å¦‚æœ useAtomDevtools çš„ name å‚æ•°æœªå®šä¹‰ï¼Œå°†ä½¿ç”¨æ­¤å€¼ã€‚
tasksAtom.debugLabel = 'Tasks'

export const useTasksDevtools = () => {
  // åªéœ€ä¼ é€’ä¸€ä¸ªç”¨äºè°ƒè¯•çš„ atom å³å¯è°ƒç”¨é’©å­ã€‚
  useAtomDevtools(tasksAtom)

  // æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹å‚æ•°
  useAtomDevtools<Task[]>(tasksAtom)

  // ä½ å¯ä»¥å°†ä¸¤ä¸ª devtools å®ä¾‹é™„åŠ åˆ°åŒä¸€ä¸ª atomï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰åç§°åŒºåˆ†å®ƒä»¬ã€‚
  useAtomDevtools(tasksAtom, 'Tasks (Instance 1)')
  useAtomDevtools(tasksAtom, 'Tasks (Instance 2)')
}
```

## useAtomsDevtools {#useatomsdevtools}

âš ï¸ æ³¨æ„ï¼šæ­¤é’©å­å¤„äºå®éªŒé˜¶æ®µï¼ˆæ¬¢è¿åé¦ˆï¼‰ï¼Œå¹¶ä¸”åªåœ¨ `process.env.NODE_ENV !== 'production'` ç¯å¢ƒä¸­å·¥ä½œã€‚

`useAtomsDevtools` æ˜¯ `useAtomDevtools` çš„å…¨æ•è·ç‰ˆæœ¬ï¼Œå®ƒæ˜¾ç¤ºå­˜å‚¨ä¸­çš„æ‰€æœ‰ atomsï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºç‰¹å®šçš„ä¸€ä¸ªã€‚

```ts
function useAtomsDevtools(
  name: string,
  options?: {
    store?: Store
    enabled?: boolean
  },
): void
```

å®ƒéœ€è¦ä¸€ä¸ª `name` å‚æ•°ï¼Œç”¨äºå‘½å Redux devtools å®ä¾‹ï¼Œä»¥åŠä¸€ä¸ª `store` å‚æ•°ã€‚

ä½œä¸ºæ­¤ API çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦å°† `useAtomsDevtools` æ”¾åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä¸­æ¶ˆè€—çš„ atoms åº”ä½äº React æ ‘çš„è¯¥ç»„ä»¶ï¼ˆä¸‹é¢ç¤ºä¾‹ä¸­çš„ `AtomsDevtools`ï¼‰ä¸‹æ–¹ã€‚
`AtomsDevtools` ç»„ä»¶å¯ä»¥è¢«è§†ä¸ºæˆ‘ä»¬åº”ç”¨çš„æœ€ä½³å®è·µã€‚

### ç¤ºä¾‹ {#example}

```jsx
const countAtom = atom(0);
const doubleCountAtom = atom((get) => get(countAtom) * 2);

function Counter() {
  const  [count, setCount] =  useAtom(countAtom);
  const  [doubleCount] =  useAtom(doubleCountAtom);

  ...
}

const AtomsDevtools = ({ children }) => {
  useAtomsDevtools('demo')
  return children
}

export default function App()  {
  return (
    <AtomsDevtools>
      <Counter />
    </AtomsDevtools>
  )
 }
```

<CodeSandbox id="3xobn" />

## useAtomsSnapshot {#useatomssnapshot}

âš ï¸ æ³¨æ„ï¼šæ­¤é’©å­åªåœ¨ `process.env.NODE_ENV !== 'production'` ç¯å¢ƒä¸­å·¥ä½œã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå®ƒè¿”å›ä¸€ä¸ªé™æ€çš„ç©ºå€¼ã€‚

`useAtomsSnapshot` ä¼šå¯¹å½“å‰æŒ‚è½½çš„ atoms åŠå…¶çŠ¶æ€è¿›è¡Œå¿«ç…§ã€‚

```ts
function useAtomsSnapshot(options?: { store?: Store }): AtomsSnapshot
```

å®ƒæ¥å—ä¸€ä¸ª `store` å‚æ•°ï¼Œå¹¶å°†è¿”å›ä¸€ä¸ª `AtomsSnapshot`ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ª `Map<AnyAtom, unknown>`ã€‚ä½ å¯ä»¥ä½¿ç”¨ `Map` API æ¥éå† atoms åŠå…¶çŠ¶æ€ã€‚
è¿™ä¸ªé’©å­ä¸»è¦ç”¨äºè°ƒè¯•å’Œ devtools çš„ç”¨ä¾‹ã€‚

ä½¿ç”¨è¿™ä¸ªé’©å­æ—¶è¦å°å¿ƒï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´ç»„ä»¶åœ¨æ‰€æœ‰çŠ¶æ€å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ã€‚

### ç¤ºä¾‹ {#example}

```jsx
import { Provider } from 'jotai'
import { useAtomsSnapshot } from 'jotai-devtools/utils'

const RegisteredAtoms = () => {
  const atoms = useAtomsSnapshot()

  return (
    <div>
      <p>Atom count: {atoms.size}</p>
      <div>
        {Array.from(atoms).map(([atom, atomValue]) => (
          <p key={`${atom}`}>{`${atom.debugLabel}: ${atomValue}`}</p>
        ))}
      </div>
    </div>
  )
}

const App = () => (
  <Provider>
    <RegisteredAtoms />
  </Provider>
)
```

## useGotoAtomsSnapshot {#usegotoatomssnapshot}

âš ï¸ æ³¨æ„ï¼šæ­¤é’©å­åªåœ¨ `process.env.NODE_ENV !== 'production'` ç¯å¢ƒä¸­å·¥ä½œã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå®ƒåƒä¸€ä¸ªç©ºå‡½æ•°ä¸€æ ·å·¥ä½œã€‚

`useGotoAtomsSnapshot` å°†æ›´æ–°å½“å‰çš„ Jotai çŠ¶æ€ä»¥åŒ¹é…ä¼ é€’çš„å¿«ç…§ã€‚

```ts
function useGotoAtomsSnapshot(options?: {
  store?: Store
}): (values: Iterable<readonly [AnyAtom, unknown]>) => void
```

æ­¤é’©å­è¿”å›ä¸€ä¸ªå›è°ƒï¼Œè¯¥å›è°ƒæ¥å—æ¥è‡ª `useAtomsSnapshot` é’©å­çš„ `snapshot` å¹¶å°†æ›´æ–° Jotai çŠ¶æ€ã€‚å®ƒæ¥å—ä¸€ä¸ª `store` å‚æ•°ã€‚
æ­¤é’©å­ä¸»è¦ç”¨äºè°ƒè¯•å’Œ devtools çš„ç”¨ä¾‹ã€‚

### ç¤ºä¾‹ {#example}

```jsx
import { Provider } from 'jotai'
import { useAtomsSnapshot, useGotoAtomsSnapshot } from 'jotai-devtools/utils'

const petAtom = atom('cat')
const colorAtom = atom('blue')

const UpdateSnapshot = () => {
  const snapshot = useAtomsSnapshot()
  const goToSnapshot = useGotoAtomsSnapshot()
  return (
    <button
      onClick={() => {
        const newSnapshot = new Map(snapshot)
        newSnapshot.set(petAtom, 'dog')
        newSnapshot.set(colorAtom, 'green')
        goToSnapshot(newSnapshot)
      }}
    >
      Go to snapshot
    </button>
  )
}
```
